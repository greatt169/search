BX.namespace("BX.Report");if(typeof BX.Report.setSelectValue==="undefined"){BX.Report.setSelectValue=function(e,t){var i,s;var r=false;var l=!!e.getAttribute("multiple");if(!(t instanceof Array))t=[t];for(i=0;i<e.options.length;i++){for(s in t){if(e.options[i].value==t[s]){if(!r){r=true;e.selectedIndex=i}e.options[i].selected=true;break}}if(!l&&r)break}}}if(typeof BX.Report.rebuildSelect==="undefined"){BX.Report.rebuildSelect=function(e,t,i){var s,r,l,n;var o=false;var a;if(!(i instanceof Array))i=[i];if(e){a=!!e.getAttribute("multiple");while(s=e.lastChild)e.removeChild(s);for(l=0;l<t.length;l++){r=document.createElement("option");r.value=t[l]["id"];r.innerHTML=t[l]["title"];try{e.add(r,e.options[null])}catch(c){r=document.createElement("option");r.text=t[l]["title"];e.add(r,null)}if(!o||a){for(n=0;n<i.length;n++){if(t[l]["id"]==i[n]){r.selected=true;if(!o){o=true;e.selectedIndex=l}break}}}}}}}if(typeof BX.Report.FilterFieldSelectorManagerClass==="undefined"){BX.Report.FilterFieldSelectorManagerClass=function(){var e=function(e){this._selectors={}};e.prototype={addSelector:function(e){var t=null,i="",s="",r="";if(e["USER_TYPE_ID"])i=e["USER_TYPE_ID"];if(e["ENTITY_ID"])s=e["ENTITY_ID"];if(e["FIELD_NAME"])r=e["FIELD_NAME"];if(i&&s&&r&&(!this._selectors[s]||!this._selectors[s][r])){switch(i){case"crm":t=new BX.Report.CrmFilterFieldSelectorClass(e);if(t){if(!this._selectors[s])this._selectors[s]={};this._selectors[s][r]=t}break;case"crm_status":t=new BX.Report.CrmStatusFilterFieldSelectorClass(e);if(t){if(!this._selectors[s])this._selectors[s]={};this._selectors[s][r]=t}break;case"iblock_element":t=new BX.Report.IblockElementFilterFieldSelectorClass(e);if(t){if(!this._selectors[s])this._selectors[s]={};this._selectors[s][r]=t}break;case"iblock_section":t=new BX.Report.IblockSectionFilterFieldSelectorClass(e);if(t){if(!this._selectors[s])this._selectors[s]={};this._selectors[s][r]=t}break}}return t},getSelector:function(e,t){var i=null;if(this._selectors[e]&&this._selectors[e][t])i=this._selectors[e][t];return i}};return e}()}if(typeof BX.Report.CrmFilterFieldSelectorClass==="undefined"){BX.Report.CrmFilterFieldSelectorClass=function(){var e=function(e){this._settings=e;this.entityType=e["USER_TYPE_ID"]||"";this.entityId=e["ENTITY_ID"]||"";this.fieldName=e["FIELD_NAME"]||"";this.crmId=[];this.crmName=[]};e.prototype={getSetting:function(e,t){return typeof this._settings[e]!="undefined"?this._settings[e]:t},getMessage:function(e){var t="";if(BX.type.isString(e)&&e.length>0&&this._settings["messages"]&&this._settings["messages"][e]){t=this._settings["messages"][e]}return t},makeFilterField:function(e,t,i){var s,r,l,n,o;if(!this.entityType||!this.entityId||!this.fieldName||!e||!BX.type.isDomNode(e)){return null}o=this.crmId.length;n=this.entityId+"_"+this.fieldName+"["+o+"]";s=BX.create("A",{attrs:{id:"crm-"+n+"-open","class":"report-select-popup-link",style:"cursor: pointer;",href:""},text:this.getMessage("choice")});r=BX.create("SPAN",{attrs:{id:"crm-"+n+"-box",name:"report-filter-value-control-crm",ufSelectorIndex:o.toString()},children:[BX.create("DIV",{attrs:{"class":"crm-button-open"},children:[s]})]});if(BX.type.isDomNode(t)&&t.parentNode===e)e.insertBefore(r,t);else e.appendChild(r);if(!BX.type.isString(i)||i.length<=0)i=n;l=CRM.Set(s,i,"",this.getSetting("ELEMENT",[]),this.getSetting("PREFIX","Y")==="Y",this.getSetting("MULTIPLE","N")==="Y",this.getSetting("ENTITY_TYPE",{}),this.getSetting("MESSAGES",{}));this.crmId.push(l);this.crmName.push(n);BX.bind(s,"click",BX.delegate(obCrm[l].Open,obCrm[l]));return r},getFilterValue:function(e){var t,i,s,r,l,n;t=[];i=this.crmId[e];s=obCrm[i];r=this.crmName[e];l=BX("crm-"+i+"_"+r+"-input-box");if(l){n=BX.findChildren(l,{tag:"input",attr:{type:"text"}});if(n instanceof Array&&n.length>0){for(var o in n){if(n.hasOwnProperty(o))t.push(n[o].value)}}}switch(t.length){case 0:t="";break;case 1:t=t[0];break}return t},setFilterValue:function(e,t){var i,s,r;i=this.crmId[e];s=obCrm[i];if(s){if(BX.type.isArray(t)){for(r=0;r<t.length;r++)s.PopupSetItem(t[r])}else{s.PopupSetItem(t)}}}};return e}()}if(typeof BX.Report.CrmStatusFilterFieldSelectorClass==="undefined"){BX.Report.CrmStatusFilterFieldSelectorClass=function(){var e=function(e){this._settings=e;this.entityType=e["USER_TYPE_ID"]||"";this.entityId=e["ENTITY_ID"]||"";this.fieldName=e["FIELD_NAME"]||"";this.selectId=[]};e.prototype={getSetting:function(e,t){return typeof this._settings[e]!="undefined"?this._settings[e]:t},getMessage:function(e){var t="";if(BX.type.isString(e)&&e.length>0&&this._settings["messages"]&&this._settings["messages"][e]){t=this._settings["messages"][e]}return t},makeFilterField:function(e,t,i){var s,r,l,n;if(!this.entityType||!this.entityId||!this.fieldName||!e||!BX.type.isDomNode(e)){return null}n=this.selectId.length;l=this.entityId+"_"+this.fieldName+"["+n+"]";if(!BX.type.isString(i)||i.length<=0)i=l;r=BX.create("SPAN",{attrs:{name:"report-filter-value-control-"+l,"class":"report-filter-vcc",ufSelectorIndex:n.toString()},children:[s=BX.create("SELECT",{attrs:{id:l,"class":"reports-filter-select-small",name:i+"[]",multiple:"multiple",size:this.getSetting("LIST_HEIGHT",3),style:"width: 225px;"}})]});if(s)BX.Report.rebuildSelect(s,this.getSetting("ITEMS"),"");if(BX.type.isDomNode(t)&&t.parentNode===e)e.insertBefore(r,t);else e.appendChild(r);this.selectId.push(l);return r},getFilterValue:function(e){var t,i,s,r,l=BX(this.selectId[e]),n="";if(l){if(l.tagName==="SELECT"&&l.getAttribute("multiple")==="multiple"){t=l.options;s=[];r=0;for(i=0;i<t.length;i++){if(t[i].selected)s[r++]=t[i].value}n=s.length>0?s:""}else{n=l.value}}return n},setFilterValue:function(e,t){var i=BX(this.selectId[e]);if(i)BX.Report.setSelectValue(i,t)}};return e}()}if(typeof BX.Report.IblockElementFilterFieldSelectorClass==="undefined"){BX.Report.IblockElementFilterFieldSelectorClass=function(){var e=function(e){this._settings=e;this.entityType=e["USER_TYPE_ID"]||"";this.entityId=e["ENTITY_ID"]||"";this.fieldName=e["FIELD_NAME"]||"";this.selectId=[]};e.prototype={getSetting:function(e,t){return typeof this._settings[e]!="undefined"?this._settings[e]:t},getMessage:function(e){var t="";if(BX.type.isString(e)&&e.length>0&&this._settings["messages"]&&this._settings["messages"][e]){t=this._settings["messages"][e]}return t},makeFilterField:function(e,t,i){var s,r,l,n;if(!this.entityType||!this.entityId||!this.fieldName||!e||!BX.type.isDomNode(e)){return null}n=this.selectId.length;l=this.entityId+"_"+this.fieldName+"["+n+"]";if(!BX.type.isString(i)||i.length<=0)i=l;r=BX.create("SPAN",{attrs:{name:"report-filter-value-control-"+l,"class":"report-filter-vcc",ufSelectorIndex:n.toString()},children:[s=BX.create("SELECT",{attrs:{id:l,"class":"reports-filter-select-small",name:i+"[]",multiple:"multiple",size:this.getSetting("LIST_HEIGHT",3),style:"width: 225px;"}})]});if(s)BX.Report.rebuildSelect(s,this.getSetting("ITEMS"),"");if(BX.type.isDomNode(t)&&t.parentNode===e)e.insertBefore(r,t);else e.appendChild(r);this.selectId.push(l);return r},getFilterValue:function(e){var t,i,s,r,l=BX(this.selectId[e]),n="";if(l){if(l.tagName==="SELECT"&&l.getAttribute("multiple")==="multiple"){t=l.options;s=[];r=0;for(i=0;i<t.length;i++){if(t[i].selected)s[r++]=t[i].value}n=s.length>0?s:""}else{n=l.value}}return n},setFilterValue:function(e,t){var i=BX(this.selectId[e]);if(i)BX.Report.setSelectValue(i,t)}};return e}()}if(typeof BX.Report.IblockSectionFilterFieldSelectorClass==="undefined"){BX.Report.IblockSectionFilterFieldSelectorClass=function(){var e=function(e){this._settings=e;this.entityType=e["USER_TYPE_ID"]||"";this.entityId=e["ENTITY_ID"]||"";this.fieldName=e["FIELD_NAME"]||"";this.selectId=[]};e.prototype={getSetting:function(e,t){return typeof this._settings[e]!="undefined"?this._settings[e]:t},getMessage:function(e){var t="";if(BX.type.isString(e)&&e.length>0&&this._settings["messages"]&&this._settings["messages"][e]){t=this._settings["messages"][e]}return t},makeFilterField:function(e,t,i){var s,r,l,n;if(!this.entityType||!this.entityId||!this.fieldName||!e||!BX.type.isDomNode(e)){return null}n=this.selectId.length;l=this.entityId+"_"+this.fieldName+"["+n+"]";if(!BX.type.isString(i)||i.length<=0)i=l;r=BX.create("SPAN",{attrs:{name:"report-filter-value-control-"+l,"class":"report-filter-vcc",ufSelectorIndex:n.toString()},children:[s=BX.create("SELECT",{attrs:{id:l,"class":"reports-filter-select-small",name:i+"[]",multiple:"multiple",size:this.getSetting("LIST_HEIGHT",3),style:"width: 225px;"}})]});if(s)BX.Report.rebuildSelect(s,this.getSetting("ITEMS"),"");if(BX.type.isDomNode(t)&&t.parentNode===e)e.insertBefore(r,t);else e.appendChild(r);this.selectId.push(l);return r},getFilterValue:function(e){var t,i,s,r,l=BX(this.selectId[e]),n="";if(l){if(l.tagName==="SELECT"&&l.getAttribute("multiple")==="multiple"){t=l.options;s=[];r=0;for(i=0;i<t.length;i++){if(t[i].selected)s[r++]=t[i].value}n=s.length>0?s:""}else{n=l.value}}return n},setFilterValue:function(e,t){var i=BX(this.selectId[e]);if(i)BX.Report.setSelectValue(i,t)}};return e}()}
//# sourceMappingURL=script.map.js