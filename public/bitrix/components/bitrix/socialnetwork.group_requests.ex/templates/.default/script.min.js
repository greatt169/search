(function(){if(!!BX.BXSGRE){return}BX.BXSGRE={iframe:false,errorBlock:null,mode:null};BX.BXSGRE.init=function(e){if(typeof e!="undefined"){if(typeof e.iframe!="undefined"){this.iframe=!!e.iframe}if(BX.type.isNotEmptyString(e.errorBlockName)&&BX(e.errorBlockName)){this.errorBlock=BX(e.errorBlockName)}if(typeof e.mode!="undefined"){this.mode=e.mode}}if(BX("sonet_group_requests_in_form_button_submit")){BX.bind(BX("sonet_group_requests_in_form_button_submit"),"click",BX.delegate(function(e){this.submitForm(e,{type:"in",action:"accept"});e.preventDefault()},this))}if(BX("sonet_group_requests_in_form_button_reject")){BX.bind(BX("sonet_group_requests_in_form_button_reject"),"click",BX.delegate(function(e){this.submitForm(e,{type:"in",action:"reject"});e.preventDefault()},this))}if(BX("sonet_group_requests_out_form_button_reject")){BX.bind(BX("sonet_group_requests_out_form_button_reject"),"click",BX.delegate(function(e){this.submitForm(e,{type:"out",action:"reject"});e.preventDefault()},this))}if(BX("sonet_group_requests_in_check_all")){BX.bind(BX("sonet_group_requests_in_check_all"),"click",BX.delegate(function(e){this.checkAll(e.currentTarget)},this))}if(BX("sonet_group_requests_out_check_all")){BX.bind(BX("sonet_group_requests_out_check_all"),"click",BX.delegate(function(e){this.checkAll(e.currentTarget)},this))}this.processUserList(BX("invite-main-wrap-in"));this.processUserList(BX("invite-main-wrap-out"));BX.addCustomEvent("SidePanel.Slider:onMessage",BX.delegate(function(e){if(e.getEventId()=="sonetGroupEvent"){var t=e.getData();if(BX.util.in_array(this.mode,["ALL","OUT"])&&BX.type.isNotEmptyString(t.code)&&t.code=="afterInvite"){BX.SocialnetworkUICommon.reload()}}},this))};BX.BXSGRE.processUserList=function(e){if(BX(e)){var t=null;if(BX(e)){var o=BX.findChildren(BX(e),{className:"invite-user-link"},true);for(var i=0,n=o.length;i<n;i++){BX.bind(o[i],"click",function(e){if(BX.type.isNotEmptyString(BX.getEventTarget(e).href)){top.location.href=BX.getEventTarget(e).href}e.preventDefault()});t=o[i].getAttribute("bx-user-id");if(t){BX.tooltip(t,o[i].id)}}}}};BX.BXSGRE.submitForm=function(e,t){var o=null,i=null;if(typeof t!="undefined"){if(BX.type.isNotEmptyString(t.type)){o=t.type}if(BX.type.isNotEmptyString(t.action)){i=t.action}}if(!o||!i){return false}var n=e.currentTarget;BX.SocialnetworkUICommon.hideError(this.errorBlock);BX.SocialnetworkUICommon.showButtonWait(n);var r=o=="out"?"form_requests_out":"form_requests";if(BX("requests_action_"+o)){BX("requests_action_"+o).value=i}BX.ajax.submitAjax(document.forms[r],{url:document.forms[r].getAttribute("action"),method:"POST",dataType:"json",onsuccess:BX.delegate(function(e){BX.SocialnetworkUICommon.hideButtonWait(n);if(typeof e.MESSAGE!="undefined"&&e.MESSAGE=="SUCCESS"&&typeof e.URL!="undefined"){if(window===top.window){top.location.href=e.URL}else{window.top.BX.SidePanel.Instance.postMessageAll(window,"sonetGroupEvent",{code:o=="out"?"afterRequestOutDelete":"afterRequestDelete",data:{}});BX.SocialnetworkUICommon.reload()}}else if(typeof e.MESSAGE!="undefined"&&e.MESSAGE=="ERROR"&&typeof e.ERROR_MESSAGE!="undefined"&&e.ERROR_MESSAGE.length>0){BX.SocialnetworkUICommon.showError(e.ERROR_MESSAGE,this.errorBlock)}},this),onfailure:BX.delegate(function(e){BX.SocialnetworkUICommon.hideButtonWait(n);BX.SocialnetworkUICommon.showError(BX.message("SONET_GRE_T_ERROR"),this.errorBlock)},this)});return false};BX.BXSGRE.checkAll=function(e){var t=null,o=BX.findChildren(e.parentNode.parentNode.parentNode,{tag:"input"},true);if(!e.checked){for(t=1;t<o.length;t++){o[t].checked=false;BX.removeClass(o[t].parentNode.parentNode.parentNode,"invite-list-active")}}else{for(t=1;t<o.length;t++){o[t].checked=true;BX.addClass(o[t].parentNode.parentNode.parentNode,"invite-list-active")}}}})();