BX.namespace("BX.Catalog.Admin");BX.Catalog.Admin.IblockChangePrice=function(){var e={selectEl:{},inputEl:{},checkboxEl:{},spanEl:{},radioEl:{},labelEl:{}};var l=null;var t={onePriceType:"",nullValue:"",equalPriceTypes:"",basePriceChange:"",destinationPriceEmpty:"",sourcePriceEmpty:""};var i="";return{init:function(a){e.selectEl.changing=BX("tableActionChangingSelect");e.selectEl.unit=BX("tableUnitsSelect");e.selectEl.priceTypeInitial=BX("tablePriceTypeIdSelect");e.selectEl.resultMask=BX("resultMaskSelect");e.selectEl.priceType=BX("initialPriceTypeSelect");e.spanEl.resultValue=BX("resultValueSpan");e.inputEl.example=BX("exampleSourceValueInput");e.inputEl.difference=BX("differenceValueInput");e.inputEl.valuePrice=BX("tableValueChangingPriceInput");e.labelEl.priceType=BX("initialPriceTypeLabel");e.labelEl.difference=BX("differenceValueLabel");e.labelEl.resultMask=BX("resultMaskLabel");e.radioEl.radioButtons=document.getElementsByName("formatResultRadio");e.checkboxEl.priceType=BX("initialPriceTypeCheckbox");e.checkboxEl.difference=BX("differenceValueCheckbox");e.checkboxEl.resultMask=BX("resultMaskCheckbox");l=a.tableReloadId||null;t=a.alertMessages||"";if(BX.type.isNotEmptyString(a.basePriceType))i=a.basePriceType;BX.bind(e.inputEl.valuePrice,"input",BX.delegate(function(e){this.inputDigitalMask(e.target)},this));BX.bind(e.inputEl.difference,"input",BX.delegate(function(e){this.reloadExample();this.inputDigitalMask(e.target)},this));BX.bind(e.inputEl.example,"input",BX.delegate(function(e){this.reloadExample();this.inputDigitalMask(e.target)},this));BX.bind(e.checkboxEl.difference,"change",BX.delegate(function(){this.reloadExample();this.showHideInitialElement(e.checkboxEl.difference,e.labelEl.difference,e.inputEl.difference)},this));BX.bind(e.checkboxEl.resultMask,"change",BX.delegate(function(){this.reloadExample();this.showHideInitialElement(e.checkboxEl.resultMask,e.labelEl.resultMask,e.selectEl.resultMask)},this));BX.bind(e.checkboxEl.priceType,"change",BX.delegate(function(l){if(e.selectEl.priceType.length===1){l.target.checked=false;window.alert(t.onePriceType);return false}this.showHideInitialElement(e.checkboxEl.priceType,e.labelEl.priceType,e.selectEl.priceType)},this));BX.bind(e.selectEl.resultMask,"change",BX.delegate(this.reloadExample,this));BX.bindDelegate(BX("chp_radioTable"),"change",{name:"formatResultRadio"},BX.proxy(this.reloadExample,this));BX.bind(e.radioEl,"change",BX.delegate(this.reloadExample,this));BX.bind(BX("savebtn"),"click",BX.delegate(function(){if(!this.checkPriceTypes())return;if(e.inputEl.valuePrice.value!==""||e.inputEl.valuePrice.value!=0){var i=0;var a=0;var c=document.querySelector('input[name="formatResultRadio"]:checked');document.getElementsByName("chprice_format_result")[0].value=c.value;document.getElementsByName("chprice_result_mask")[0].value=e.selectEl.resultMask.options[e.selectEl.resultMask.selectedIndex].value;if(e.checkboxEl.difference.checked){i=e.inputEl.difference.value}document.getElementsByName("chprice_difference_value")[0].value=i;if(e.checkboxEl.priceType.checked){a=e.selectEl.priceType.options[e.selectEl.priceType.selectedIndex].value}document.getElementsByName("chprice_initial_price_type")[0].value=a;if(e.selectEl.changing.value==="add"){document.getElementsByName("chprice_value_changing_price")[0].value=e.inputEl.valuePrice.value}else{document.getElementsByName("chprice_value_changing_price")[0].value=-1*e.inputEl.valuePrice.value}document.getElementsByName("chprice_units")[0].value=e.selectEl.unit.options[e.selectEl.unit.selectedIndex].value;document.getElementsByName("chprice_id_price_type")[0].value=e.selectEl.priceTypeInitial.options[e.selectEl.priceTypeInitial.selectedIndex].value;document.getElementsByName("action_button")[0].value="change_price";BX.submit(top[l].FORM,"change_price");top.BX.WindowManager.Get().Close()}else{window.alert(t.nullValue)}},this));this.reloadExample();return this},showHideInitialElement:function(e,l,t){if(e.checked){l.classList.remove("inactive-element");t.disabled=false;t.classList.remove("inactive-element")}else{l.classList.add("inactive-element");t.disabled=true;t.classList.add("inactive-element")}},inputDigitalMask:function(e){e.value=e.value.replace(/[^\d,.]*/g,"").replace(/\,/g,".").replace(/([,.])[,.]+/g,"$1").replace(/^[^\d]*(\d+([.,]\d{0,5})?).*$/g,"$1")},reloadExample:function(){var l=0;var t=0;var i=0;var a=e.inputEl.example;var c=e.inputEl.difference;var n=e.checkboxEl.difference;var r=e.spanEl.resultValue;var s=e.selectEl.resultMask.options[e.selectEl.resultMask.selectedIndex].value;if(!isNaN(parseFloat(a.value))){t=parseFloat(a.value)}if(n.checked&&!isNaN(parseFloat(c.value))){l=parseFloat(c.value)}switch(document.querySelector('input[name="formatResultRadio"]:checked').value){case"ceil":i=Math.ceil(t*s)/s-l;if(i<0){i=0}r.innerHTML=i;break;case"floor":i=Math.floor(t*s)/s-l;if(i<0){i=0}r.innerHTML=i;break;case"round":i=Math.round(t*s)/s-l;if(i<0){i=0}r.innerHTML=i}},checkPriceTypes:function(){if(!BX.type.isElementNode(e.checkboxEl.priceType)||!BX.type.isElementNode(e.selectEl.priceType)||!BX.type.isElementNode(e.selectEl.priceTypeInitial))return true;if(e.selectEl.priceTypeInitial.value==="0"){window.alert(t.destinationPriceEmpty);return false}if(!e.checkboxEl.priceType.checked)return true;if(e.selectEl.priceType.value==="0"){window.alert(t.sourcePriceEmpty);return false}if(e.selectEl.priceTypeInitial.value!=="0"&&e.selectEl.priceType.value!=="0"){if(e.selectEl.priceTypeInitial.value===e.selectEl.priceType.value){window.alert(t.equalPriceTypes);return false}else if(e.selectEl.priceTypeInitial.length>1&&e.selectEl.priceTypeInitial.value===i){return window.confirm(t.basePriceChange)}}return true}}};
//# sourceMappingURL=iblock_change_price.map.js